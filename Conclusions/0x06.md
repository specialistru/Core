üß¨ **–≠–∫—Å–ø–µ—Ä—Ç ‚Ññ6 ‚Äî –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ MVCC –∏ Concurrency Control**

---

### üéØ –û–±–ª–∞—Å—Ç—å –∞–Ω–∞–ª–∏–∑–∞:

* MVCC (Multi-Version Concurrency Control) —Å compressed chains
* Snapshot Isolation
* TxID visibility rules
* –§–æ–Ω–æ–≤–∞—è –æ—á–∏—Å—Ç–∫–∞ (`vacuum`, GC)
* –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å `txn_manager`, `buffer_pool`, `table_engine`

---

### ‚úÖ –ü—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ MVCC-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –≤ `sap_hana_architecture_19.puml`:

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç          | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π                                              |
| ------------------ | -------------------------------------------------------- |
| `mvcc_engine`      | –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –±–ª–æ–∫ ‚Äî —è–≤–Ω–æ –≤—ã–¥–µ–ª–µ–Ω, —Ö–æ—Ä–æ—à–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞        |
| `snapshot_manager` | –ï—Å—Ç—å –º–æ–¥—É–ª—å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–Ω–∏–º–∫–∞–º–∏ ‚Äî üëç                 |
| `txn_manager`      | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤ ‚Äî TxID |
| `vacuum_engine`    | –ï—Å—Ç—å –±–ª–æ–∫, –æ—Ç–≤–µ—á–∞—é—â–∏–π –∑–∞ —É–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –≤–µ—Ä—Å–∏–π          |
| `recovery_service` | –õ–æ–≥–∏—á–µ—Å–∫–∏ –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ MVCC-—Ü–µ–ø–æ—á–µ–∫          |

---

### ‚ö†Ô∏è –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ –∏ —Å–ª–∞–±—ã–µ –º–µ—Å—Ç–∞:

| –ü—Ä–æ–±–ª–µ–º–∞                                       | –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ                                                         |
| ---------------------------------------------- | ------------------------------------------------------------------- |
| ‚ùå `mvcc_engine` –Ω–µ –∏–º–µ–µ—Ç —Å–≤—è–∑–∏ —Å `buffer_pool` | –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä—è–º–æ–π —Å–≤—è–∑–∏ –º–µ—à–∞–µ—Ç –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —á—Ç–µ–Ω–∏—è –≤–∏–¥–∏–º—ã—Ö –≤–µ—Ä—Å–∏–π    |
| ‚ùå –ù–µ—Ç `tx_visibility_checker`                  | –õ–æ–≥–∏–∫–∞ –≤–∏–¥–∏–º–æ—Å—Ç–∏ –≤–µ—Ä—Å–∏–π (TxID vs Snapshot) –Ω–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ –∫–∞–∫ –±–ª–æ–∫ |
| ‚ùå –ù–µ—Ç `compressed_chain_manager`               | –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–æ–º–ø—Ä–µ—Å—Å–∏–∏ MVCC-—Ü–µ–ø–æ—á–µ–∫ –Ω–µ –≤—ã–¥–µ–ª–µ–Ω–∞                       |
| ‚ùå `vacuum_engine` –Ω–µ —Å–≤—è–∑–∞–Ω —Å `table_engine`   | –ù–µ–ø–æ–Ω—è—Ç–Ω–æ, –∫–∞–∫ –≤–µ—Ä—Å–∏–∏ —É–¥–∞–ª—è—é—Ç—Å—è –∏–∑ —Ç–∞–±–ª–∏—Ü                           |
| ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç `undo_log_manager`               | –í–∞–∂–Ω–æ –¥–ª—è rollback –∏ point-in-time –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è                   |

---

### üíØ –û—Ü–µ–Ω–∫–∞: **83 / 100**

---

### üîß –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é:

1. **–î–æ–±–∞–≤–∏—Ç—å `tx_visibility_checker`** ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–∏–¥–∏–º–æ—Å—Ç–∏ —Å—Ç—Ä–æ–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ TxID + snapshot
2. **–î–æ–±–∞–≤–∏—Ç—å `compressed_chain_manager`** ‚Äî –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ü–µ–ø–æ—á–µ–∫ –≤–µ—Ä—Å–∏–π –≤ –ø–∞–º—è—Ç–∏
3. **–í–≤–µ—Å—Ç–∏ `undo_log_manager`** ‚Äî –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ rollbacks –∏ savepoints
4. **–°–≤—è–∑–∞—Ç—å `mvcc_engine` ‚Üî `buffer_pool`, `table_engine`** ‚Äî —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –∏ —É–¥–∞–ª–µ–Ω–∏—è
5. **–°–≤—è–∑–∞—Ç—å `vacuum_engine` —Å `storage_layer`** ‚Äî –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Ñ–∏–∑–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

---

üß¨ **–ó–∞–∫–ª—é—á–µ–Ω–∏–µ:** MVCC-–±–∞–∑–∞ –º–æ—â–Ω–∞—è, —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –∫–ª—é—á–µ–≤—ã–º–∏ –±–ª–æ–∫–∞–º–∏, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ö–∞–Ω–∏–∑–º–∞ –≤–∏–¥–∏–º–æ—Å—Ç–∏, —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ü–µ–ø–æ—á–∫–∞–º–∏ –∏ rollback.

