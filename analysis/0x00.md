# Подробное описание полей JSON структуры для анализа исходников C / H

```json
{
  "project_name": "MyProject",
  "version": "1.2.3",
  "git_branch": "feature/refactor-utils",
  "files": [
    {
      "file_id": "123e4567-e89b-12d3-a456-426614174000",
      "filename": "utils.c",
      "path": "src/",
      "type": "source",
      "category": "utility",
      "lines": 42,
      "lines_of_code": 38,
      "comment_ratio": 0.10,
      "functions_count": 1,
      "dependencies": {
        "includes": ["stdio.h", "utils.h"],
        "used_by": ["main.c"]
      },
      "functions": [
        {
          "name": "log_message",
          "return_type": "void",
          "params": ["const char* msg"],
          "defined": true,
          "version": "1.0.0"
        }
      ],
      "last_modified": "2025-07-21T15:03:22+00:00",
      "hash": "c3ab8ff13720e8ad9047dd39466b3c89d5b1c1a7ef4b4e6a8f59c22e5f3a5a5a7",
      "warnings": 3,
      "errors": 0,
      "cyclomatic_complexity": 5,
      "test_coverage": 0.85,
      "has_unit_tests": true,
      "size_bytes": 2048,
      "encoding": "UTF-8",
      "static_analysis": {
        "security_issues": 0,
        "style_violations": 2
      },
      "content": "#include <stdio.h>\n#include \"utils.h\"\n\nvoid log_message(const char* msg) {\n    printf(\"%s\\n\", msg);\n}"
    }
  ]
}
```

---

### Общее по проекту

| Поле              | Тип    | Описание                                 | Как заполнять                                |
| ----------------- | ------ | ---------------------------------------- | -------------------------------------------- |
| **project\_name** | string | Название проекта                         | Название проекта в текстовом виде            |
| **version**       | string | Текущая версия проекта                   | Семантическая версия, например "1.2.3"       |
| **git\_branch**   | string | Ветка Git, на которой ведётся разработка | Имя ветки, например "feature/refactor-utils" |

---

### По файлам (массив `files`)

| Поле                 | Тип           | Описание                                                | Как заполнять                                                    |
| -------------------- | ------------- | ------------------------------------------------------- | ---------------------------------------------------------------- |
| **file\_id**         | string (UUID) | Уникальный идентификатор файла                          | Генерировать UUID или уникальную строку для каждого файла        |
| **filename**         | string        | Имя файла                                               | Например, "utils.c"                                              |
| **path**             | string        | Путь до файла относительно корня проекта                | Например, "src/"                                                 |
| **type**             | string        | Тип файла: "source" или "header"                        | Исходный код — "source", заголовочный — "header"                 |
| **category**         | string        | Категория файла (например, "core", "utility", "driver") | Классифицировать по функциональному назначению                   |
| **lines**            | integer       | Общее количество строк в файле                          | Подсчитать все строки в файле                                    |
| **lines\_of\_code**  | integer       | Количество строк с кодом (без пустых и комментариев)    | Анализ кода, исключая пустые строки и комментарии                |
| **comment\_ratio**   | float (0-1)   | Доля строк комментариев относительно общего числа строк | Вычисляется как (кол-во строк комментариев / общее кол-во строк) |
| **functions\_count** | integer       | Количество функций, объявленных/определённых в файле    | Посчитать все функции в файле                                    |

---

### Зависимости

| Поле             | Тип          | Описание                                     | Как заполнять                                          |
| ---------------- | ------------ | -------------------------------------------- | ------------------------------------------------------ |
| **dependencies** | object       | Зависимости файла                            |                                                        |
| - **includes**   | array of str | Заголовочные файлы, включённые в данный файл | Список всех `#include` заголовков, напр. \["stdio.h"]  |
| - **used\_by**   | array of str | Файлы, которые используют данный файл        | Список файлов, где данный файл включается/используется |

---

### Описание функций

| Поле               | Тип             | Описание                                                          | Как заполнять                                      |
| ------------------ | --------------- | ----------------------------------------------------------------- | -------------------------------------------------- |
| **functions**      | array of object | Список функций в файле                                            | Каждая функция — отдельный объект                  |
| - **name**         | string          | Имя функции                                                       | Например, "log\_message"                           |
| - **return\_type** | string          | Тип возвращаемого значения                                        | Например, "void", "int"                            |
| - **params**       | array of string | Параметры функции                                                 | Список параметров, например \["const char\* msg"]  |
| - **defined**      | boolean         | Определена ли функция в данном файле (true), или только объявлена | true — функция определена, false — только прототип |
| - **version**      | string          | Версия функции (если ведётся учет версий API)                     | Семантическая версия функции, например "1.0.0"     |

---

### Метаданные файла

| Поле                       | Тип              | Описание                                             | Как заполнять                                                       |
| -------------------------- | ---------------- | ---------------------------------------------------- | ------------------------------------------------------------------- |
| **last\_modified**         | string (ISO8601) | Дата и время последнего изменения файла              | Формат `YYYY-MM-DDTHH:mm:ss+00:00` — UTC время или с часовым поясом |
| **hash**                   | string           | SHA256-хеш содержимого файла                         | Вычислить SHA256 по полному содержимому файла                       |
| **warnings**               | integer          | Количество предупреждений из статического анализа    | Вывести число предупреждений (например, из lint или clang)          |
| **errors**                 | integer          | Количество ошибок из статического анализа            | Аналогично, но для ошибок                                           |
| **cyclomatic\_complexity** | integer          | Цикломатическая сложность файла или ключевой функции | Рассчитать по методике Маккейба (McCabe)                            |
| **test\_coverage**         | float (0-1)      | Процент покрытия файла модульными тестами            | Выражать дробью (например, 0.85 = 85%)                              |
| **has\_unit\_tests**       | boolean          | Есть ли для файла юнит-тесты                         | true если есть, false — если нет                                    |
| **size\_bytes**            | integer          | Размер файла в байтах                                | Количество байт в исходном файле                                    |
| **encoding**               | string           | Кодировка файла                                      | Обычно "UTF-8" или другая кодировка                                 |

---

### Статический анализ (опционально)

| Поле                    | Тип     | Описание                                  | Как заполнять                                      |
| ----------------------- | ------- | ----------------------------------------- | -------------------------------------------------- |
| **static\_analysis**    | object  | Результаты статического анализа           | Можно интегрировать результаты из SonarQube и т.п. |
| - **security\_issues**  | integer | Количество найденных проблем безопасности | Например, число уязвимостей                        |
| - **style\_violations** | integer | Количество нарушений кодстайла            | Кол-во стайл-гайдов нарушений                      |

---

### Исходный код файла

| Поле        | Тип    | Описание                                                  | Как заполнять                              |
| ----------- | ------ | --------------------------------------------------------- | ------------------------------------------ |
| **content** | string | Полный исходный код файла с экранированными спецсимволами | Весь текст файла с переносами строк и т.п. |

---

# Краткие советы по заполнению

* Используйте инструменты анализа кода для автоматического подсчёта метрик (cloc, lizard, cppcheck, clang-tidy, gcov, sonar-scanner и др.).
* Хеш — вычисляйте на полный текст исходника, чтобы контролировать изменения.
* В `dependencies.includes` — отражайте реальные `#include` из исходников.
* В `functions.params` для более точного анализа можно позже перейти на структуру с типами и именами параметров.
* Для больших проектов генерация JSON должна быть автоматизирована, чтобы обновлять метрики и содержимое.
