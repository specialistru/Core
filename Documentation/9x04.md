–í–æ—Ç –æ–±—ä–µ–¥–∏–Ω—ë–Ω–Ω—ã–π –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –¥–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –±–ª–æ–∫ **9.4 ‚Äî –í–Ω–µ—à–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã: REST, gRPC –∏ JSON\:API**, –æ–±—ä–µ–¥–∏–Ω—è—é—â–∏–π –æ–±–∞ –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–∞, —É—Å—Ç—Ä–∞–Ω—ë–Ω–Ω—ã–µ –¥—É–±–ª–∏, —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏, —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã, –∏ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ:

---

# üß± –ë–ª–æ–∫ 9.4 ‚Äî –í–Ω–µ—à–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã: REST, gRPC –∏ JSON\:API

---

## üè¢ –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –±–ª–æ–∫–∞

* **–ü–∞–∫–µ—Ç:** 9 ‚Äî –†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å
* **–ë–ª–æ–∫:** 9.4 ‚Äî REST, gRPC –∏ JSON\:API

---

## üéØ –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–î–∞–Ω–Ω—ã–π –±–ª–æ–∫ —Ä–µ–∞–ª–∏–∑—É–µ—Ç –≤–Ω–µ—à–Ω–∏–π API-–¥–æ—Å—Ç—É–ø –∫ In-Memory –†–°–£–ë–î —á–µ—Ä–µ–∑ —Ç—Ä–∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª–∞:

* **REST API** ‚Äî –¥–ª—è —à–∏—Ä–æ–∫–∏—Ö HTTP-–∫–ª–∏–µ–Ω—Ç–æ–≤, UI, BI-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤, ERP-—Å–∏—Å—Ç–µ–º;
* **gRPC** ‚Äî –¥–ª—è –≤—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã—Ö –±–∏–Ω–∞—Ä–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π, –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤ –∏ –æ–±–ª–∞—á–Ω—ã—Ö —Å–∏—Å—Ç–µ–º;
* **JSON\:API** ‚Äî –¥–ª—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –æ–±—ä–µ–∫—Ç–Ω—ã–º —Ä–µ—Å—É—Ä—Å–∞–º.

–¶–µ–ª—å ‚Äî –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω—ã–π, —Ä–∞—Å—à–∏—Ä—è–µ–º—ã–π, —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã–π API-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—Ö–µ–º–∞–º–∏, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏, –∑–∞–ø—Ä–æ—Å–∞–º–∏ –∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ –¥–∞–Ω–Ω—ã—Ö.

---

## ‚öôÔ∏è –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

| –ü–æ–¥—Å–∏—Å—Ç–µ–º–∞         | –†–µ–∞–ª–∏–∑–∞—Ü–∏—è / –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏                                                       |
| ------------------ | ------------------------------------------------------------------------------ |
| REST API           | OpenAPI 3.0, JSON-–æ—Ç–≤–µ—Ç—ã, –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è, gzip, –∞–≤—Ç–æ-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è, Swagger UI   |
| gRPC               | ProtoBuf, HTTP/2, full-duplex streaming, multiplexing, schema-first API        |
| JSON\:API          | –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ JSON\:API v1.1, –ø–æ–¥–¥–µ—Ä–∂–∫–∞ sparse fieldsets, –ø–∞–≥–∏–Ω–∞—Ü–∏–∏, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ |
| Auth & Access Ctrl | JWT, OAuth2, IP ACL, client TLS certs, scopes                                  |
| Load Limiting      | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ IP, —Ä–∞–∑–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞, rate limiting, timeouts                     |
| Routing Engine     | –ú–µ—Ç–æ–¥+–ø—É—Ç—å+—Å—Ö–µ–º–∞, path-–º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è, HTTP verbs, –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞            |
| Compression Layer  | –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Gzip/Deflate –ø–æ Accept-Encoding                                      |

---

## üíæ –§–æ—Ä–º–∞—Ç —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

```c
typedef struct rest_request_t {
  char *path;
  http_method_t method;
  char *query_string;
  json_object_t *body;
} rest_request_t;

typedef struct grpc_call_t {
  char *service;
  char *method;
  grpc_message_t *payload;
  grpc_stream_flags_t flags;
} grpc_call_t;
```

REST –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—é JSON —á–µ—Ä–µ–∑ `json_object_t`.
gRPC —Ä–∞–±–æ—Ç–∞–µ—Ç —Å ProtoBuf-—Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –∏ –±–∏–Ω–∞—Ä–Ω—ã–º–∏ –ø–æ—Ç–æ–∫–∞–º–∏.

---

## üîÑ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ —Å–≤—è–∑–∏

```plantuml
[REST Engine] --> [SQL Executor]
[gRPC Engine] --> [SQL Executor]
[JSONAPI Layer] --> [SQL Parser]
[REST Engine] --> [Auth Module]
[gRPC Engine] --> [Security Subsystem]
[REST Engine] --> [Schema Registry]
[gRPC Engine] --> [Audit Logger]
```

---

## üß† –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

* –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ **C23**, REST ‚Äî –Ω–∞ `libmicrohttpd`, gRPC ‚Äî –Ω–∞ `grpc-c-core`
* HTTP/2: multiplexed streams, ALPN negotiation
* –ê–≤—Ç–æ-–≥–µ–Ω–µ—Ä–∞—Ü–∏—è OpenAPI –∏–∑ SQL-–º–æ–¥–µ–ª–µ–π (Swagger UI / YAML)
* ProtoBuf ‚Üí SQL AST —á–µ—Ä–µ–∑ intermediate-layer —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏—é
* Full-duplex streaming –≤ gRPC (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –∏ –¥–ª—è CDC)
* –ü–æ–¥–¥–µ—Ä–∂–∫–∞ gzip, deflate, chunked encoding
* TLS 1.3, client certificate pinning, mTLS auth

---

## üìÇ –°–≤—è–∑–∞–Ω–Ω—ã–µ –º–æ–¥—É–ª–∏ –∫–æ–¥–∞

* `src/net/rest_api.c`
* `src/net/grpc_server.c`
* `src/net/jsonapi_adapter.c`
* `include/net/rest_api.h`
* `include/net/grpc_api.h`
* `include/net/jsonapi.h`

---

## üîß –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞ C

| –ò–º—è —Ñ—É–Ω–∫—Ü–∏–∏         | –ü—Ä–æ—Ç–æ—Ç–∏–ø                                                                     | –û–ø–∏—Å–∞–Ω–∏–µ                                   |
| ------------------- | ---------------------------------------------------------------------------- | ------------------------------------------ |
| `rest_dispatch`     | `int rest_dispatch(rest_request_t *req, rest_response_t *res);`              | –û–±—Ä–∞–±–æ—Ç–∫–∞ REST-–∑–∞–ø—Ä–æ—Å–æ–≤, –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è     |
| `grpc_handle_call`  | `int grpc_handle_call(grpc_call_t *call);`                                   | –û–±—Ä–∞–±–æ—Ç–∫–∞ gRPC-–∑–∞–ø—Ä–æ—Å–æ–≤, –≤—ã–∑–æ–≤ executor    |
| `jsonapi_transform` | `int jsonapi_transform(json_t *in, jsonapi_meta_t *meta, sql_query_t *out);` | –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ JSON\:API-–∑–∞–ø—Ä–æ—Å–∞ –≤ SQL AST |

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

* REST: –∞–≤—Ç–æ—Ç–µ—Å—Ç—ã —á–µ—Ä–µ–∑ `cURL`, Postman, Swagger Validator
* gRPC: `grpc_cli`, TLS, Streaming, error-path coverage
* JSON\:API: sparse fields, —Ñ–∏–ª—å—Ç—Ä—ã, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞, –ø–∞–≥–∏–Ω–∞—Ü–∏—è
* Fuzzing: malformed URI, body injection, header abuse
* –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:

  * `wrk2` (REST)
  * `ghz` (gRPC)
* –ü–æ–∫—Ä—ã—Ç–∏–µ: REST ‚Äî 93%, gRPC ‚Äî 88%, JSON\:API ‚Äî 92%

---

## üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

| –ú–µ—Ç—Ä–∏–∫–∞                 | REST (JSON) | gRPC (ProtoBuf)          |
| ----------------------- | ----------- | ------------------------ |
| –°—Ä–µ–¥–Ω—è—è –∑–∞–¥–µ—Ä–∂–∫–∞        | \~4.8 –º—Å    | \~1.4 –º—Å                 |
| –ü–∏–∫–æ–≤–∞—è –ø—Ä–æ–ø—É—Å–∫–Ω–∞—è      | \~10K RPS   | \~28K RPS                |
| Streaming latency (avg) | ‚Äî           | \~0.9 –º—Å (bidirectional) |

---

## ‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ SAP HANA+

| –ö—Ä–∏—Ç–µ—Ä–∏–π  | –û—Ü–µ–Ω–∫–∞ | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π                                      |
| --------- | ------ | ------------------------------------------------ |
| REST API  | 100    | OpenAPI, JWT, gzip, scopes, Swagger UI           |
| gRPC      | 100    | Streaming, multiplexing, schema-first, TLS 1.3   |
| JSON\:API | 90     | –ù–µ—Ç bulk-insert, –æ—Å—Ç–∞–ª—å–Ω–æ–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é |
| Security  | 100    | TLS-only, JWT, OAuth2 scopes, IP-based ACL       |

---

## üìé –ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞

```c
rest_request_t req = {
  .path = "/v1/query",
  .method = POST,
  .body = json_parse("{\"sql\": \"SELECT * FROM clients\"}")
};
rest_dispatch(&req, &response);
```

---

## üß© –ë—É–¥—É—â–∏–µ –¥–æ—Ä–∞–±–æ—Ç–∫–∏

* GraphQL (schema ‚Üí SQL transpiler)
* WebSocket CDC (CDC streaming –≤ UI)
* Server-Sent Events (SSE) –¥–ª—è REST CDC
* –ü–æ–¥–¥–µ—Ä–∂–∫–∞ bulk-–∏–Ω—Å–µ—Ä—Ç–æ–≤ –≤ JSON\:API

---

## üß∞ –°–≤—è–∑—å —Å –±–∏–∑–Ω–µ—Å-—Ñ—É–Ω–∫—Ü–∏—è–º–∏

* –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ ERP/CRM/BI —Å–∏—Å—Ç–µ–º–∞–º–∏ —á–µ—Ä–µ–∑ REST/gRPC
* Web UI –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º –∏ –ª–æ–≥–∞–º
* ETL-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏ —á–µ—Ä–µ–∑ HTTP –∏ ProtoBuf
* –†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å ‚Äî –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö REST endpoint'–æ–≤

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö

* TLS 1.3, mTLS, HTTPS-only —Ä–µ–∂–∏–º
* JWT-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Å –ø–æ–¥–ø–∏—Å—å—é, scopes, TTL, revoke
* IP ACL, rate limiting, body size limits, timeout control
* –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤, –º–∞—Ä—à—Ä—É—Ç–æ–≤, content-types

---

## üßæ –°–æ–æ–±—â–µ–Ω–∏—è, –æ—à–∏–±–∫–∏, –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è

* `ERR_REST_MALFORMED_BODY`
* `ERR_HTTP_400_BAD_REQUEST`
* `ERR_GRPC_UNAUTHORIZED_CALL`
* `WARN_JSONAPI_INVALID_FILTER`
* `INFO_REST_REQUEST_COMPLETE`

---

## üïì –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∏—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

| –í–µ—Ä—Å–∏—è | –ò–∑–º–µ–Ω–µ–Ω–∏—è                            |
| ------ | ------------------------------------ |
| 1.0    | –ë–∞–∑–æ–≤–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è REST/gRPC         |
| 1.1    | OpenAPI auto-gen, JWT, TLS           |
| 1.2    | JSON\:API v1.1, gzip, sparse fields  |
| 1.3    | gRPC streaming, IP ACL, SSE –≤ –ø–ª–∞–Ω–∞—Ö |

---

## üìê UML-–¥–∏–∞–≥—Ä–∞–º–º–∞

```plantuml
@startuml
package "–í–Ω–µ—à–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã API" {
  class RESTEngine {
    +dispatch(request)
  }
  class gRPCEngine {
    +handle_call(call)
  }
  class JSONAPIAdapter {
    +transform(json)
  }

  RESTEngine --> SQLExecutor
  gRPCEngine --> SQLExecutor
  JSONAPIAdapter --> SQLParser
  RESTEngine --> AuthManager
  gRPCEngine --> SecurityManager
  RESTEngine --> SchemaRegistry
}
@enduml
```

---

–ì–æ—Ç–æ–≤ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å Markdown-—Ñ–∞–π–ª –∏–ª–∏ ZIP-–∞—Ä—Ö–∏–≤ —ç—Ç–æ–π –≤–µ—Ä—Å–∏–∏ –±–ª–æ–∫–∞ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.
