# 5.11 ‚Äî –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (RBAC, ABAC, TDE, ACL, JWT, sandbox)

## üè¢ –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –±–ª–æ–∫–∞

**–ü–∞–∫–µ—Ç 5 ‚Äî BI, ML –∏ OLAP**
**–ë–ª–æ–∫ 5.11 ‚Äî –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (—Ä–æ–ª–µ–≤–æ–π –¥–æ—Å—Ç—É–ø, —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ, –ø–æ–ª–∏—Ç–∏–∫–∏)**

## üåü –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—É—é –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å, –¥–æ—Å—Ç—É–ø –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–æ–ª–µ–π, –∞—Ç—Ç—Ä–∏–±—É—Ç–æ–≤, —Å–µ—Ç–µ–≤—ã—Ö ACL, –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é JWT/—Ç–æ–∫–µ–Ω–∞–º–∏, —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ TDE, –∞ —Ç–∞–∫–∂–µ sandbox-–æ—Ç—á–µ–∂–¥–µ–Ω–∏–µ UDF/UDAF.

## ‚öôÔ∏è –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

| –ü–æ–¥—Å–∏—Å—Ç–µ–º–∞  | –†–µ–∞–ª–∏–∑–∞—Ü–∏—è / –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏                       |
| ----------- | ---------------------------------------------- |
| RBAC        | –ü—Ä–∞–≤–∞ –Ω–∞ –≥—Ä—É–ø–ø—ã/—Ä–æ–ª–∏/–æ–±—ä–µ–∫—Ç—ã                   |
| ABAC        | –ü–æ–ª–∏—Ç–∏–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–µ—Å—Å–∏–∏/–∞—Ç—Ç—Ä–∏–±—É—Ç–æ–≤           |
| ACL         | –°–µ—Ç–µ–≤—ã–µ –ø–æ—Ä—Ç—ã, –¥–∏–∞–ø–∞–∑–æ–Ω—ã IP, —Ç–µ–≥–∏              |
| JWT / OAuth | –°–µ—Å—Å–∏–∏, —Ç–æ–∫–µ–Ω—ã, –∫–ª—é—á–∏ RSA/EC                   |
| TDE / TLS   | –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–æ–≤/—Ç—Ä–∞—Ñ–∏–∫–∞, —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã         |
| Sandbox UDF | Lua/WASM UDF/—Ç—Ä–∏–≥–≥–µ—Ä—ã –≤ –æ—Ç—á–µ–∂–¥–µ–Ω–Ω–æ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ |

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä—ã

```c
typedef struct access_policy_t {
  char role[MAX_ROLE];
  char resource[MAX_NAME];
  uint8_t permission;  // READ, WRITE, ADMIN
} access_policy_t;

typedef struct jwt_session_t {
  char token[512];
  time_t expiry;
  char user[MAX_USER];
} jwt_session_t;
```

## üîÑ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```plantuml
SessionManager --> RBAC
SessionManager --> ABAC
SessionManager --> JWTValidator
JWTValidator --> RSAKeyStore
AccessEngine --> ACLManager
AccessEngine --> TDEngine
SQLExecutor --> SandboxEngine
```

## üßê –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

* TDE: Transparent Data Encryption (AES256-GCM)
* RSA/EC256-–æ—Å–Ω–æ–≤–∞–Ω–Ω–∞—è JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
* UDF sandbox: seccomp + namespace isolation

## üìÇ –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

* `src/security/rbac.c`
* `src/security/abac.c`
* `src/security/jwt.c`
* `src/security/tde.c`
* `src/security/acl.c`
* `include/security/access_policy.h`

## ‚öñÔ∏è –§—É–Ω–∫—Ü–∏–∏

| –ò–º—è               | –ü—Ä–æ—Ç–æ—Ç–∏–ø                                                        | –û–ø–∏—Å–∞–Ω–∏–µ                       |
| ----------------- | --------------------------------------------------------------- | ------------------------------ |
| `check_access`    | `bool check_access(const char *user, const char *resource)`     | –ü—Ä–æ–≤–µ—Ä–∫–∞ RBAC/–ê–í–ê–ö –¥–æ—Å—Ç—É–ø–∞     |
| `parse_jwt`       | `int parse_jwt(const char *token, jwt_session_t *out)`          | –†–∞–∑–±–æ—Ä JWT-—Ç–æ–∫–µ–Ω–∞, –≤–∞–ª–∏–¥–∞—Ü–∏—è   |
| `encrypt_page`    | `void encrypt_page(uint8_t *buf, size_t sz)`                    | –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –ø–∞–∫–µ—Ç–æ–≤/–¥–∏—Å–∫–∞ TDE   |
| `run_sandbox_udf` | `int run_sandbox_udf(const char *name, const udf_args_t *args)` | –í—ã–∑–æ–≤ UDF –≤ –∑–∞—â–∏—â—ë–Ω–Ω–æ–º —Å–µ–∫—Ç–æ—Ä–µ |

## üî´ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

* Unit: `tests/security/test_rbac.c`, `test_acl.c`
* Fuzz: JWT/–∞—Ç—Ç—Ä–∏–±—É—Ç—ã/–æ—à–∏–±–∫–∏ –ø–æ–ª–∏—Ç–∏–∫
* Integration: –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ SQL –∏ –¥–æ—Å—Ç—É–ø–∞

## üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

| –û–ø–µ—Ä–∞—Ü–∏—è          | –ú–µ—Ç—Ä–∏–∫–∞  |
| ----------------- | -------- |
| JWT validation    | < 0.8 –º—Å |
| ACL check         | < 0.3 –º—Å |
| Sandbox execution | < 1.5 –º—Å |

## ‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ SAP HANA+

| –ö—Ä–∏—Ç–µ—Ä–∏–π           | –û—Ü–µ–Ω–∫–∞ | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π                           |
| ------------------ | ------ | ------------------------------------- |
| RBAC/–ê–í–ê–ö-–ø–æ–ª–∏—Ç–∏–∫–∏ | 100    | –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —Å –≥—Ä–∞–Ω—É–ª—å–Ω—ã–º –¥–æ—Å—Ç—É–ø–æ–º     |
| JWT/—Ç–æ–∫–µ–Ω—ã/–∫–ª—é—á–∏   | 100    | –ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ OAuth 2.0 / JWT      |
| TDE + TLS          | 100    | AES256-—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –∏ mTLS              |
| Sandbox UDF        | 100    | Seccomp + PID/NET namespace isolation |

## üìå UML-–¥–∏–∞–≥—Ä–∞–º–º–∞

```plantuml
@startuml
entity "SessionManager" as SM
entity "RBAC" as RB
entity "ABAC" as AB
entity "JWTValidator" as JWT
entity "RSAKeyStore" as RSA
entity "AccessEngine" as ACC
entity "ACLManager" as ACL
entity "TDEngine" as TDE
entity "SQLExecutor" as SQL
entity "SandboxEngine" as SBX

SM --> RB
SM --> AB
SM --> JWT
JWT --> RSA
ACC --> ACL
ACC --> TDE
SQL --> SBX
@enduml
```

## üîó –°–≤—è–∑—å —Å –±–∏–∑–Ω–µ—Å-—Ñ—É–Ω–∫—Ü–∏—è–º–∏

* –†–æ–ª–µ–≤–æ–π –¥–æ—Å—Ç—É–ø –¥–ª—è —Ñ–∏–ª–∏–∞–ª–æ–≤/—Ä–µ–≥–∏–æ–Ω–æ–≤
* –°–µ—Å—Å–∏–∏ JWT –¥–ª—è BI/REST/–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
* –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é PCI DSS / –ó–ê–°–¢

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

* –¢—Ä–∞—Ñ–∏–∫ TLS 1.3
* –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–æ–≤ AES256-GCM
* JWT RS256/–°–µ—Å—Å–∏–∏ + TOTP
* UDF: sandbox c seccomp, cgroup, namespace

## üîÑ –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏

