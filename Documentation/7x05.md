# 7.5 ‚Äî Fuzzing, ASAN/TSAN/MSAN (–§–∞–∑–∑–∏–Ω–≥ –∏ –°–∞–Ω–∏—Ç–∞–π–∑–µ—Ä—ã)

## üè¢ –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –±–ª–æ–∫–∞

**–ü–∞–∫–µ—Ç 7 ‚Äî Observability –∏ DevOps**
**–ë–ª–æ–∫ 7.5 ‚Äî Fuzzing, ASAN/TSAN/MSAN**

# üß± –ë–ª–æ–∫ 7.2 ‚Äî –ú–µ—Ç—Ä–∏–∫–∏, –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –Ω–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å (Prometheus / OpenTelemetry / Perf)

---

## üÜî –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –±–ª–æ–∫–∞

* **–ü–∞–∫–µ—Ç:** 7 ‚Äî Observability –∏ DevOps
* **–ë–ª–æ–∫:** 7.2 ‚Äî –¢—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ (Query Execution Tracing / Timeline / Zipkin / Jaeger)

---

## üåü –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–î–∞–Ω–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤—ã—è–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ –ø–∞–º—è—Ç–∏, –≥–æ–Ω–æ–∫, –Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è –∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –≤ –∫–æ–¥–µ —è–¥—Ä–∞ –°–£–ë–î –ø—É—Ç—ë–º —Ñ–∞–∑–∑–∏–Ω–≥-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Å—Ç–∞—Ç–∏–∫–æ-–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –Ω–∞ –±–∞–∑–µ AddressSanitizer (ASAN), ThreadSanitizer (TSAN), MemorySanitizer (MSAN). –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ CI-–ø–∞–π–ø–ª–∞–π–Ω–µ –∏ –ø—Ä–∏ —Å–±–æ—Ä–∫–µ –æ—Ç–ª–∞–¥–æ—á–Ω—ã—Ö –±–∏–Ω–∞—Ä–Ω–∏–∫–æ–≤.

## ‚öôÔ∏è –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

| –ü–æ–¥—Å–∏—Å—Ç–µ–º–∞           | –†–µ–∞–ª–∏–∑–∞—Ü–∏—è / –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏              |
| -------------------- | ------------------------------------- |
| –§–∞–∑–∑–∏–Ω–≥              | libFuzzer –∏ AFL++, –º–æ–¥—É–ª—å–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ |
| –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–¥—Ä–µ—Å–æ–≤     | AddressSanitizer (ASAN)               |
| –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ–Ω–æ–∫       | ThreadSanitizer (TSAN)                |
| –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞–º—è—Ç–∏ | MemorySanitizer (MSAN)                |
| –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CI      | GitHub Actions + CMake + —Ñ–ª–∞–≥–∏ —Å–±–æ—Ä–∫–∏ |

## üíæ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è

–û—Ç–¥–µ–ª—å–Ω—ã–µ —Å–±–æ—Ä–æ—á–Ω—ã–µ —Ñ–ª–∞–≥–∏ –∏ –±–∏–Ω–∞—Ä–Ω–∏–∫–∏, –ø—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:

```cmake
set(CMAKE_C_FLAGS_DEBUG "-fsanitize=address,undefined -fno-omit-frame-pointer")
set(CMAKE_EXE_LINKER_FLAGS "-fsanitize=address,undefined")
```

## üîÑ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ —Å–≤—è–∑–∏

```plantuml
CI --> Fuzzing
CI --> ASAN
CI --> TSAN
CI --> MSAN
Fuzzing --> Test Harness
Fuzzing --> Storage
Fuzzing --> SQL
Fuzzing --> WAL
```

## üß† –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

* –í—Å–µ –º–æ–¥—É–ª–∏ —è–¥—Ä–∞ –ø–æ–∫—Ä—ã–≤–∞—é—Ç—Å—è fuzz-—Ç–µ—Å—Ç–∞–º–∏ —Å mock input
* –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ entrypoints `LLVMFuzzerTestOneInput`
* –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å AFL++ —á–µ—Ä–µ–∑ —Ñ–∞–π–ª—ã `.dict`, `.state`, `.queue/`
* –û—Ç—á—ë—Ç—ã —Ñ–∞–∑–∑–µ—Ä–∞ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ corpus –∏ crash dumps
* ASAN —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–º shadow memory layout

## üìÇ –°–≤—è–∑–∞–Ω–Ω—ã–µ –º–æ–¥—É–ª–∏ –∫–æ–¥–∞

* `tests/fuzz/fuzz_sql_parser.c`
* `tests/fuzz/fuzz_executor.c`
* `tests/fuzz/fuzz_storage.c`
* `tests/fuzz/fuzz_wal.c`
* `CMakeLists.txt` (—Ñ–ª–∞–≥–∏ —Å–±–æ—Ä–∫–∏)

## üîß –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

| –ò–º—è                      | –ü—Ä–æ—Ç–æ—Ç–∏–ø                                                       | –û–ø–∏—Å–∞–Ω–∏–µ                                     |
| ------------------------ | -------------------------------------------------------------- | -------------------------------------------- |
| `LLVMFuzzerTestOneInput` | `int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size)` | –í—Ö–æ–¥–Ω–∞—è —Ç–æ—á–∫–∞ –¥–ª—è libFuzzer                  |
| `fuzz_init`              | `void fuzz_init(void)`                                         | –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–∫—Ä—É–∂–µ–Ω–∏—è fuzz-—Ç–µ—Å—Ç–∞           |
| `fuzz_report`            | `void fuzz_report(const char *crash)`                          | –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–º–ø–∞ –ø–æ—Å–ª–µ –ø–∞–¥–µ–Ω–∏—è |

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

* Fuzz: SQL-–ø–∞—Ä—Å–µ—Ä, –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫, WAL, MVCC
* AddressSanitizer: –Ω–∞ –≤—Å–µ—Ö –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–∞—Ö
* ThreadSanitizer: –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ `make tsan`
* MemorySanitizer: —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —Ä–µ–∂–∏–º—ã

## üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

| –ú–µ—Ç—Ä–∏–∫–∞                       | –ó–Ω–∞—á–µ–Ω–∏–µ           |
| ----------------------------- | ------------------ |
| –§–∞–∑–∑–∏–Ω–≥ SQL-–º–æ–¥—É–ª—è            | 2 –º–ª–Ω inputs / —á–∞—Å |
| –î–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ use-after-free | < 50 –Ω—Å            |
| –†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å coverage        | –î–æ 94% —è–¥—Ä–∞        |

## ‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ SAP HANA+

| –ö—Ä–∏—Ç–µ—Ä–∏–π                               | –û—Ü–µ–Ω–∫–∞ | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π                            |
| -------------------------------------- | ------ | -------------------------------------- |
| –ü–æ–∫—Ä—ã—Ç–∏–µ —Ñ–∞–∑–∑–∏–Ω–≥–æ–º –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –º–æ–¥—É–ª–µ–π | 100    | WAL, SQL, MVCC, Storage –ø–æ–∫—Ä—ã—Ç—ã        |
| –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ASAN/TSAN/MSAN           | 100    | –í–∫–ª—é—á–µ–Ω—ã –≤ CI –∏ nightly-—Å–±–æ—Ä–∫–∏         |
| –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç—á—ë—Ç–æ–≤ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è      | 100    | –í—Å–µ –æ—Ç—á—ë—Ç—ã –∞–≥—Ä–µ–≥–∏—Ä—É—é—Ç—Å—è –≤ –ø–∞–π–ø–ª–∞–π–Ω–µ CI |

## üìé –ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞

```c
int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {
  return sql_parser_fuzz_entry(data, size);
}
```

## üß© –ë—É–¥—É—â–∏–µ –¥–æ—Ä–∞–±–æ—Ç–∫–∏

* –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å libEVM / WASM-–º–æ–¥—É–ª—è–º–∏
* –ì–∏–±—Ä–∏–¥–Ω—ã–π fuzz + Symbolic Execution
* Clang 18 Sanitizer Coverage Reports –≤ UI

## üìä UML-–¥–∏–∞–≥—Ä–∞–º–º–∞

```plantuml
@startuml
actor "CI Pipeline" as CI
package "Fuzzing & Sanitizers" {
  [libFuzzer] --> [SQL Parser]
  [AFL++] --> [Storage Engine]
  CI --> [ASAN]
  CI --> [TSAN]
  CI --> [MSAN]
}
@enduml
```

## üîó –°–≤—è–∑—å —Å –±–∏–∑–Ω–µ—Å-—Ñ—É–Ω–∫—Ü–∏—è–º–∏

* –ü–æ–≤—ã—à–µ–Ω–∏–µ –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç–∏ —è–¥—Ä–∞
* –£–º–µ–Ω—å—à–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –ø–æ–∏—Å–∫ –¥–µ—Ñ–µ–∫—Ç–æ–≤
* –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –≤–≤–æ–¥–∞ –¥–ª—è –≤—Å–µ—Ö ETL/BI-–ø—Ä–æ—Ü–µ—Å—Å–æ–≤

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö

* –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π (UAF, OOB, race)
* –ñ—É—Ä–Ω–∞–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∫–∞—Ä–∞–Ω—Ç–∏–Ω input —Å crash-–ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ–º
* –ö–æ–Ω—Ç—Ä–æ–ª—å shadow memory layout

## üïì –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∏—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

* v1.0 ‚Äî –ó–∞–ø—É—Å–∫ libFuzzer –Ω–∞ SQL
* v1.1 ‚Äî –î–æ–±–∞–≤–ª–µ–Ω–∏–µ AFL++ –∏ fuzz WAL
* v1.2 ‚Äî –í–∫–ª—é—á–µ–Ω–∏–µ AddressSanitizer –≤ CI
* v1.3 ‚Äî –î–æ–±–∞–≤–ª–µ–Ω–∏–µ ThreadSanitizer + MSAN

## üõë –°–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö –∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è

| –ö–æ–¥ / –¢–∏–ø      | –£—Å–ª–æ–≤–∏–µ                         | –û–ø–∏—Å–∞–Ω–∏–µ                  |
| -------------- | ------------------------------- | ------------------------- |
| `E_FUZZ_CRASH` | –ù–µ–Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ñ–∞–∑—ã    | –û—Ç—á—ë—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω –≤ `crash/` |
| `W_SANITIZER`  | –í—ã–≤–æ–¥ ASAN/TSAN –≤ stderr        | –¢—Ä–µ–±—É–µ—Ç—Å—è —Ä—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ |
| `I_FUZZ_SKIP`  | –ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π –≤—Ö–æ–¥–Ω–æ–π —Ñ–æ—Ä–º–∞—Ç | –í–≤–æ–¥ –ø—Ä–æ–ø—É—â–µ–Ω —Ñ–∞–∑–∑–µ—Ä–æ–º    |
