# 7.6 ‚Äî –ò–Ω—ä–µ–∫—Ü–∏–∏ —Å–±–æ–µ–≤ –∏ —Ö–∞–æ—Å-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

## üè¢ –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –±–ª–æ–∫–∞

**–ü–∞–∫–µ—Ç 7 ‚Äî Observability –∏ DevOps**
**–ë–ª–æ–∫ 7.6 ‚Äî –ò–Ω—ä–µ–∫—Ü–∏–∏ —Å–±–æ–µ–≤ –∏ —Ö–∞–æ—Å-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**

## üåü –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–î–∞–Ω–Ω—ã–π –±–ª–æ–∫ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è —Å–∏—Å—Ç–µ–º–Ω–æ–π –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ in-memory –°–£–ë–î –∫ —Å–±–æ—è–º, –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏, –æ—à–∏–±–∫–∞–º –∏ –æ—Ç–∫–∞–∑–∞–º. –†–µ–∞–ª–∏–∑—É–µ—Ç —Ç–µ—Ö–Ω–∏–∫—É Chaos Engineering ‚Äî —É–ø—Ä–∞–≤–ª—è–µ–º—ã–µ –∏–Ω—ä–µ–∫—Ü–∏–∏ —Å–±–æ–µ–≤, —ç–º—É–ª—è—Ü–∏—è —Å–µ—Ç–µ–≤—ã—Ö —Ä–∞–∑—Ä—ã–≤–æ–≤, –ø–æ—Ç–µ—Ä–∏ IOPS, –æ—Ç–∫–∞–∑–∞ –ø–∞–º—è—Ç–∏, –Ω–∞—Ä—É—à–µ–Ω–∏—è NUMA-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã, –æ–±—Ä—ã–≤–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –°–£–ë–î —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ø—Ä–∏ —á–∞—Å—Ç–∏—á–Ω–æ–º –∏–ª–∏ –ø–æ–ª–Ω–æ–º –Ω–∞—Ä—É—à–µ–Ω–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤.

## ‚öôÔ∏è –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

| –ü–æ–¥—Å–∏—Å—Ç–µ–º–∞                 | –†–µ–∞–ª–∏–∑–∞—Ü–∏—è / –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏                                  |
| -------------------------- | --------------------------------------------------------- |
| –ò–Ω—ä–µ–∫—Ü–∏–∏ –æ—Ç–∫–∞–∑–æ–≤           | –°–∏–º—É–ª–∏—Ä—É–µ–º—ã–µ —Å–±–æ–∏ I/O, CPU, —Å–µ—Ç–∏, –ø–∞–º—è—Ç–∏                  |
| –°—Ü–µ–Ω–∞—Ä–∏–∏ —Ö–∞–æ—Å–∞             | –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ (disk full, latency spike, node kill) |
| –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ CI/CD         | –•–∞–æ—Å-—Ç–µ—Å—Ç—ã –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –≤ nightly –∏ –ø—Ä–∏ —Ä–µ–ª–∏–∑–∞—Ö            |
| –ú–µ—Ç—Ä–∏–∫–∏ –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ | MTBF, Recovery Time, Data Loss                            |
| Sandbox –æ–∫—Ä—É–∂–µ–Ω–∏–µ          | –í—Å–µ —Å–±–æ–∏ –∏–Ω—ä–µ—Ü–∏—Ä—É—é—Ç—Å—è –≤ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –æ–∫—Ä—É–∂–µ–Ω–∏–∏           |

## üíæ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è

```c
typedef struct chaos_event_t {
  chaos_type_t type;         // DISK_FAILURE, CPU_OVERLOAD, etc.
  uint64_t start_ts;
  uint64_t duration_ns;
  char affected_module[32]; // storage, planner, tx, etc.
} chaos_event_t;
```

## üîÑ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ —Å–≤—è–∑–∏

```plantuml
package "Chaos Controller" {
  [Failure Injector] --> [Storage Engine]
  [Failure Injector] --> [Transaction Engine]
  [Failure Injector] --> [SQL Engine]
}
CI --> [Chaos Controller]
Metrics --> [Chaos Reports]
```

## üß† –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

* NUMA-unfriendly –∏–Ω—ä–µ–∫—Ü–∏–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞—Å–∫–ª–∞–¥–∫–∏
* –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ WAL-–¥–∏—Å–∫–∞, —á–∞—Å—Ç–∏—á–Ω–∞—è –ø–æ—Ç–µ—Ä—è –¥–∞–Ω–Ω—ã—Ö
* –≠–º—É–ª—è—Ü–∏—è –æ—Ç–∫–∞–∑–∞ —Å–µ—Ç–µ–≤—ã—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ –≤ multi-node –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è—Ö
* –ò–Ω—ä–µ–∫—Ü–∏—è GC-—Å—Ç–æ–ø–æ–≤ –∏ –ø–∞—É–∑ MVCC

## üìÇ –°–≤—è–∑–∞–Ω–Ω—ã–µ –º–æ–¥—É–ª–∏ –∫–æ–¥–∞

* `src/chaos/chaos_controller.c`
* `src/chaos/failure_injector.c`
* `tests/chaos/test_node_failure.c`
* `include/chaos/chaos_event.h`

## üîß –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

| –ò–º—è                    | –ü—Ä–æ—Ç–æ—Ç–∏–ø                                    | –û–ø–∏—Å–∞–Ω–∏–µ                                     |
| ---------------------- | ------------------------------------------- | -------------------------------------------- |
| `chaos_inject_event`   | `void chaos_inject_event(chaos_event_t *e)` | –ò–Ω—ä–µ–∫—Ü–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–±–æ—è –≤ —É–∫–∞–∑–∞–Ω–Ω—ã–π –º–æ–¥—É–ª—å |
| `chaos_reset`          | `void chaos_reset(void)`                    | –û—á–∏—Å—Ç–∫–∞ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ —Å—Ü–µ–Ω–∞—Ä–∏—è —Å–±–æ—è |
| `chaos_report_metrics` | `void chaos_report_metrics(void)`           | –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏    |

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

* Fuzz: –∏–Ω—ä–µ–∫—Ü–∏—è —Å–ª—É—á–∞–π–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π –æ—Ç–∫–∞–∑–∞
* Integration: —Ö–∞–æ—Å-—Ç–µ—Å—Ç –Ω–∞ —É—Ä–æ–≤–Ω–µ –≤—Å–µ–π –°–£–ë–î
* Soak: –¥–ª–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ (24h+, 10^6 —Å–æ–±—ã—Ç–∏–π)
* Coverage: –≤–ª–∏—è–Ω–∏–µ –Ω–∞ MVCC, WAL, Query Executor

## üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

| –ú–µ—Ç—Ä–∏–∫–∞                    | –ó–Ω–∞—á–µ–Ω–∏–µ                  |
| -------------------------- | ------------------------- |
| MTTR –ø—Ä–∏ I/O –æ—Ç–∫–∞–∑–µ        | < 3.2 —Å                   |
| –°—Ä–µ–¥–Ω—è—è –¥–µ–≥—Ä–∞–¥–∞—Ü–∏—è latency | < 5% –ø—Ä–∏ —Å–±–æ–µ –æ–¥–Ω–æ–≥–æ —É–∑–ª–∞ |
| –ü–æ—Ç–µ—Ä—è –¥–∞–Ω–Ω—ã—Ö              | 0 (–ø—Ä–∏ WAL + Snapshot)    |

## ‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ SAP HANA+

| –ö—Ä–∏—Ç–µ—Ä–∏–π                   | –û—Ü–µ–Ω–∫–∞ | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π                   |
| -------------------------- | ------ | ----------------------------- |
| –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ö–∞–æ—Å-–∏–Ω—ä–µ–∫—Ü–∏–π    | 100    | –î–∏—Å–∫, —Å–µ—Ç—å, CPU, GC, WAL      |
| –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CI/CD         | 100    | –•–∞–æ—Å —Ç–µ—Å—Ç—ã –≤ nightly pipeline |
| –ú–µ—Ç—Ä–∏–∫–∏ –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ | 100    | MTTR, Data Loss, Recovery     |

## üìé –ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞

```c
chaos_event_t ev = {
  .type = CHAOS_DISK_FAILURE,
  .start_ts = now_ns(),
  .duration_ns = 5000000000,
  .affected_module = "storage"
};
chaos_inject_event(&ev);
```

## üß© –ë—É–¥—É—â–∏–µ –¥–æ—Ä–∞–±–æ—Ç–∫–∏

* –ò–Ω—ä–µ–∫—Ü–∏–∏ –≤ Kafka/CDC –∫–∞–Ω–∞–ª—ã
* UI-–º–æ–Ω–∏—Ç–æ—Ä —Ö–∞–æ—Å–∞ –∏ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –≤ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ
* –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ eBPF –¥–ª—è –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã—Ö –æ—Ç–∫–∞–∑–æ–≤

## üìä UML-–¥–∏–∞–≥—Ä–∞–º–º–∞

```plantuml
@startuml
actor "CI/CD Pipeline" as CI
package "Chaos Controller" {
  [Failure Injector] --> [Transaction Engine]
  [Failure Injector] --> [SQL Engine]
  [Failure Injector] --> [Storage Engine]
}
CI --> [Chaos Controller]
@enduml
```

## üîó –°–≤—è–∑—å —Å –±–∏–∑–Ω–µ—Å-—Ñ—É–Ω–∫—Ü–∏—è–º–∏

* –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ—Å—Ç–∏ –±–∏–∑–Ω–µ—Å–∞ –ø—Ä–∏ —Å–±–æ—è—Ö
* –ì–∞—Ä–∞–Ω—Ç–∏—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ—Å–ª–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–∏—Ç—É–∞—Ü–∏–π
* –ê—É–¥–∏—Ç —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ –∫ –≤–Ω–µ—à–Ω–∏–º –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏—è–º

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö

* –í—Å–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –≤ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ä–µ–¥–µ (sandbox)
* –ñ—É—Ä–Ω–∞–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–∫–∞–∑–æ–≤ –∏ rollback –≤ snapshot
* –ù–µ—Ä–∞–∑—Ä—É—à–∞—é—â–∏–π —Ä–µ–∂–∏–º: —Ç–æ–ª—å–∫–æ –≤ test-stand –æ–∫—Ä—É–∂–µ–Ω–∏–∏

## üïì –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∏—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

* v1.0 ‚Äî –∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –æ—Ç–∫–∞–∑–∞ WAL
* v1.1 ‚Äî —Ö–∞–æ—Å GC + NUMA-–æ—Ç–∫–∞–∑
* v1.2 ‚Äî –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ CI/CD
* v1.3 ‚Äî –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –≤ –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

## üõë –°–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö –∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è

| –ö–æ–¥ / –¢–∏–ø          | –£—Å–ª–æ–≤–∏–µ                  | –û–ø–∏—Å–∞–Ω–∏–µ                                       |
| ------------------ | ------------------------ | ---------------------------------------------- |
| `E_CHAOS_FAIL`     | –û—à–∏–±–∫–∞ —Å–∏–º—É–ª—è—Ü–∏–∏ —Å–±–æ—è    | –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –º–æ–¥—É–ª—å –∏–ª–∏ —Ç–∏–ø —Å–±–æ—è               |
| `W_CHAOS_LATENCY`  | –ó–∞–¥–µ—Ä–∂–∫–∞ –ø—Ä–µ–≤—ã—Å–∏–ª–∞ –Ω–æ—Ä–º—É | –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –¥–µ–≥—Ä–∞–¥–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏    |
| `I_CHAOS_RECOVERY` | –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ   | –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏—è –∫ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–º—É —Ä–µ–∂–∏–º—É |
